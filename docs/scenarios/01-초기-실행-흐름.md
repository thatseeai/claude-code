# 시나리오 1: Claude Code의 첫 만남 - 초기 실행 흐름

## 이야기의 시작

개발자 지민은 터미널을 열고 프로젝트 디렉토리로 이동했다. 새로운 AI 코딩 도우미 Claude Code를 처음 사용해보기로 결심한 것이다.

```bash
cd /home/jimin/my-project
claude
```

명령어 하나로, 지민도 모르는 사이에 복잡하면서도 정교한 시스템이 깨어나기 시작했다.

## 제1막: 잠에서 깨어나다 (CLI Startup)

### 장면 1: NPM 패키지의 각성

지민이 입력한 `claude` 명령어는 전역으로 설치된 NPM 패키지를 호출했다:

```
/usr/local/lib/node_modules/@anthropic-ai/claude-code/
```

이 패키지는 마치 잠에서 깨어난 것처럼, 자신이 어디에 있는지 확인하기 시작했다:
- 현재 작업 디렉토리는 어디인가? → `/home/jimin/my-project`
- 이곳은 Git 저장소인가? → `git rev-parse --git-dir`로 확인
- 어떤 운영체제인가? → `Linux 4.4.0`
- 오늘은 무슨 날인가? → `2025-11-10`

### 장면 2: 프로젝트 설정의 발견

CLI는 프로젝트 내부를 탐색하기 시작했다. 마치 새로운 집에 들어온 손님이 집 안을 둘러보듯이.

**`.claude/` 디렉토리 탐색:**

```
/home/jimin/my-project/.claude/
    ├── commands/           # 사용자 정의 명령어들
    │   ├── commit-push-pr.md
    │   ├── oncall-triage.md
    │   └── dedupe.md
    ├── CLAUDE.md          # 프로젝트 가이드라인
    └── settings.json      # 설정 파일
```

CLI는 이 파일들을 하나하나 읽으며 지민의 프로젝트를 이해하기 시작했다.

### 장면 3: 플러그인의 집결

이제 더 흥미로운 일이 벌어졌다. Claude Code는 자신의 능력을 확장하기 위해 플러그인들을 불러모으기 시작했다:

```
/home/user/claude-code/plugins/
    ├── feature-dev/              # 기능 개발 워크플로우
    ├── security-guidance/        # 보안 가이드
    ├── learning-output-style/    # 학습 모드
    ├── explanatory-output-style/ # 설명 모드
    ├── commit-commands/          # Git 명령어들
    ├── code-review/              # 코드 리뷰
    └── pr-review-toolkit/        # PR 리뷰 도구
```

각 플러그인은 자신만의 역할을 가지고 있었다:

**feature-dev 플러그인이 말했다:**
> "나는 `/feature-dev` 명령어를 제공한다. 7단계 프로세스로 새로운 기능을 개발할 수 있도록 도와주지."

**security-guidance 플러그인이 속삭였다:**
> "나는 조용히 지켜본다. 파일을 수정할 때마다, 보안 취약점이 있는지 확인해줄게."

**learning-output-style 플러그인이 웃으며 말했다:**
> "나는 가르치는 걸 좋아해. 코드를 작성할 때마다 왜 그렇게 하는지 설명해줄게."

## 제2막: SessionStart Hook의 의식 (Session Bootstrap)

### 장면 4: Hook의 깨어남

플러그인들이 모두 모이자, 특별한 의식이 시작되었다. **SessionStart Hook**의 실행이다.

**learning-output-style 플러그인의 SessionStart Hook:**

```bash
# File: plugins/learning-output-style/hooks-handlers/session-start.sh
#!/bin/bash

echo '{
  "hookSpecificOutput": {
    "hookEventName": "SessionStart",
    "additionalContext": "🎓 학습 모드가 활성화되었습니다. 사용자와 함께 배우고 성장합니다..."
  }
}'
```

이 훅이 실행되면서, Claude의 시스템 프롬프트에 추가 지침이 삽입되었다:

```
[시스템 프롬프트에 추가됨]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
학습 모드: 활성
- 사용자의 기여를 요청하세요
- 코드를 작성한 이유를 설명하세요
- 대안적인 접근법을 제시하세요
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**explanatory-output-style 플러그인의 SessionStart Hook:**

```bash
# File: plugins/explanatory-output-style/hooks-handlers/session-start.sh
#!/bin/bash

echo '{
  "hookSpecificOutput": {
    "hookEventName": "SessionStart",
    "additionalContext": "★ Insight ─────────────────────────────────────\n코드를 작성하기 전후에 교육적 인사이트를 제공합니다..."
  }
}'
```

이렇게 두 개의 훅이 차례로 실행되면서, Claude의 성격이 형성되었다.

### 장면 5: 도구 상자 준비

Hook들이 실행을 마치자, Claude는 자신이 사용할 수 있는 도구들을 점검했다:

**사용 가능한 도구들:**
```
✓ Read        - 파일 읽기
✓ Write       - 파일 쓰기
✓ Edit        - 파일 편집
✓ Bash        - 셸 명령어 실행
✓ Glob        - 파일 패턴 검색
✓ Grep        - 코드 검색
✓ WebFetch    - 웹에서 정보 가져오기
✓ WebSearch   - 웹 검색
✓ TodoWrite   - 할 일 목록 관리
✓ Task        - 전문 에이전트 실행
```

각 도구는 권한 설정에 따라 제한될 수 있었다. 특히 `Bash` 도구는 주의가 필요했다.

## 제3막: 세션 초기화 완료 (Session Ready)

### 장면 6: 컨텍스트의 구축

모든 준비가 끝나자, Claude는 현재 상황을 완전히 파악했다:

**세션 컨텍스트:**
```json
{
  "session_id": "011CUymoK8z8HKgZKRV7dM8N",
  "working_directory": "/home/jimin/my-project",
  "git_repository": true,
  "current_branch": "claude/scenario-documentation-011CUymoK8z8HKgZKRV7dM8N",
  "platform": "linux",
  "today": "2025-11-10",
  "available_commands": [
    "/dedupe - Find duplicate GitHub issues",
    "/oncall-triage - Triage GitHub issues",
    "/commit-push-pr - Commit, push, and open a PR"
  ],
  "hooks_active": {
    "SessionStart": ["learning-output-style", "explanatory-output-style"],
    "PreToolUse": ["security-guidance"]
  }
}
```

### 장면 7: Git 상태 확인

Claude는 지민의 프로젝트가 Git 저장소라는 것을 알아차리고, 현재 상태를 확인했다:

```bash
git status
```

**결과:**
```
Current branch: claude/scenario-documentation-011CUymoK8z8HKgZKRV7dM8N
Status: (clean)

Recent commits:
8702f09 Merge branch 'anthropics:main' into main
9495237 Merge pull request #1 from thatseeai/...
970fff4 Merge pull request #11326 from anthropics/...
```

모든 것이 깨끗했다. 작업을 시작할 준비가 되었다.

### 장면 8: 프로젝트 가이드라인 로딩

Claude는 `.claude/CLAUDE.md` 파일이 있는지 확인했다. 이 파일은 프로젝트의 "헌법"과 같은 것이었다:

```markdown
# 프로젝트 가이드라인

- TypeScript를 사용합니다
- 테스트는 Jest로 작성합니다
- 커밋 메시지는 Conventional Commits를 따릅니다
- ...
```

이 가이드라인은 Claude가 모든 작업을 수행할 때 참고하는 기준이 되었다.

## 제4막: 사용자를 맞이하다 (Ready for Input)

### 장면 9: 첫 인사

모든 초기화가 완료되자, Claude는 지민에게 인사를 건넸다:

```
Claude Code v1.0.0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📁 Working Directory: /home/jimin/my-project
🌿 Git Branch: claude/scenario-documentation-011CUymoK8z8HKgZKRV7dM8N
⚡ Model: claude-sonnet-4-5

Available Commands:
  /dedupe           - Find duplicate GitHub issues
  /oncall-triage    - Triage GitHub issues
  /commit-push-pr   - Commit, push, and open a PR

Active Modes:
  🎓 Learning Mode  - Explanations and insights enabled
  🔒 Security Check - Enabled for file modifications

Type your request or /help for assistance.
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

>
```

커서가 깜빡이며 지민의 입력을 기다렸다.

## 에필로그: 시작의 순간

이 모든 과정은 단 몇 초 만에 일어났다. 지민은 화면의 프롬프트를 바라보며 생각했다:

*"이제 무엇을 만들어볼까?"*

Claude는 조용히 기다렸다. 7개의 플러그인이 로드되었고, 3개의 사용자 정의 명령어가 준비되었으며, 보안 훅이 작동 중이었다. SessionStart 훅들은 학습 모드와 설명 모드를 활성화했다.

모든 것이 준비되었다. 이제 진짜 이야기가 시작될 차례였다.

---

## 기술적 세부사항

### 초기화 순서 요약

```
1. CLI 실행 (claude 명령어)
   ↓
2. 환경 정보 수집
   - 작업 디렉토리
   - Git 저장소 여부
   - OS 정보
   - 날짜/시간
   ↓
3. 프로젝트 설정 로드
   - .claude/ 디렉토리
   - CLAUDE.md
   - settings.json
   ↓
4. 플러그인 발견 및 로드
   - plugins/ 디렉토리 스캔
   - plugin.json 읽기
   - 명령어/에이전트/훅 등록
   ↓
5. SessionStart Hook 실행
   - learning-output-style
   - explanatory-output-style
   - 시스템 프롬프트 확장
   ↓
6. 도구 초기화
   - 권한 확인
   - allowed-tools 검증
   ↓
7. 세션 컨텍스트 구축
   - session_id 생성
   - Git 상태 확인
   - 환경 변수 설정
   ↓
8. 사용자 인터페이스 표시
   - 환영 메시지
   - 사용 가능한 명령어 목록
   - 프롬프트 표시
   ↓
9. 입력 대기 상태
   - 사용자 입력 기다림
   - 스트리밍 응답 준비 완료
```

### 관련 파일 경로

| 컴포넌트 | 파일 경로 |
|---------|----------|
| CLI 실행 파일 | `/usr/local/lib/node_modules/@anthropic-ai/claude-code/` |
| Learning Hook | `plugins/learning-output-style/hooks-handlers/session-start.sh` |
| Explanatory Hook | `plugins/explanatory-output-style/hooks-handlers/session-start.sh` |
| 프로젝트 명령어 | `.claude/commands/*.md` |
| 플러그인 메타데이터 | `plugins/*/.claude-plugin/plugin.json` |

### 핵심 개념

1. **SessionStart Hook**: 세션이 시작될 때 실행되어 시스템 프롬프트에 추가 컨텍스트를 삽입
2. **Plugin Discovery**: 자동으로 플러그인을 찾아 로드하는 메커니즘
3. **Context Building**: 프로젝트 환경을 완전히 이해하기 위한 정보 수집
4. **Tool Initialization**: 사용 가능한 도구들의 권한과 제약사항 설정

이것이 Claude Code가 깨어나는 순간의 이야기다. 단순해 보이는 `claude` 명령어 뒤에는 이렇게 복잡하고 정교한 시스템이 숨어있다.
